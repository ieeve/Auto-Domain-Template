(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0f6179dc"],{"361e":function(e,t,a){},"3e9f":function(e,t,a){"use strict";var r=a("b775");t["a"]={Add:function(e){return Object(r["a"])({url:"/sys_role/Add",method:"post",data:e})},Del:function(e){return Object(r["a"])({url:"/sys_role/Del",method:"post",data:e})},Update:function(e){return Object(r["a"])({url:"/sys_role/Update",method:"post",data:e})},GetById:function(e){return Object(r["a"])({url:"/sys_role/GetById",method:"get",params:{id:e}})},GetTreeTable:function(){return Object(r["a"])({url:"/sys_role/GetTreeTable",method:"get"})},GetTreeSelect:function(){return Object(r["a"])({url:"/sys_role/GetTreeSelect",method:"get"})}}},a118:function(e,t,a){"use strict";var r=a("b775");t["a"]={Add:function(e){return Object(r["a"])({url:"/sys_menu/Add",method:"post",data:e})},Del:function(e){return Object(r["a"])({url:"/sys_menu/Del",method:"post",data:e})},Update:function(e){return Object(r["a"])({url:"/sys_menu/Update",method:"post",data:e})},GetById:function(e){return Object(r["a"])({url:"/sys_menu/GetById",method:"get",params:{id:e}})},GetTreeTable:function(){return Object(r["a"])({url:"/sys_menu/GetTreeTable",method:"get"})},GetTreeSelect:function(){return Object(r["a"])({url:"/sys_menu/GetTreeSelect",method:"get"})}}},a15b:function(e,t,a){"use strict";var r=a("23e7"),l=a("44ad"),n=a("fc6a"),o=a("a640"),i=[].join,s=l!=Object,c=o("join",",");r({target:"Array",proto:!0,forced:s||!c},{join:function(e){return i.call(n(this),void 0===e?",":e)}})},a199:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"plan"},[a("el-row",{staticClass:"page-tools"},[a("el-col",{attrs:{span:20}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.AddDialogOpen}},[e._v("新增")]),a("el-button",{attrs:{type:"success",size:"mini"},on:{click:e.editClick}},[e._v("修改")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:e.delClick}},[e._v("删除")])],1),a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[a("el-button-group",[a("el-button",{attrs:{size:"mini"},on:{click:e.fetchData}},[a("i",{staticClass:"el-icon-refresh"})]),a("el-checkbox",{attrs:{label:"换行",size:"mini",border:""},model:{value:e.isLineWarp,callback:function(t){e.isLineWarp=t},expression:"isLineWarp"}})],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.orgTable.loading,expression:"orgTable.loading"}],ref:"multipleTable",staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.orgTable.data,"highlight-current-row":"","row-key":"id","default-expand-all":e.defaultexpand,"tree-props":e.orgTable.defaultProps},on:{"select-all":e.onSelectAll,"selection-change":e.selectItem,"row-click":e.onSelectOp}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{prop:"name",label:"名称",width:"180"}}),a("el-table-column",{attrs:{prop:"id",label:"序号",width:"180"}}),a("el-table-column",{attrs:{prop:"notes",label:"说明"}}),a("el-table-column",{attrs:{prop:"status",label:"状态"}}),a("el-table-column",{attrs:{prop:"seqno",label:"显示顺序"}}),a("el-table-column",{attrs:{prop:"menus",label:"菜单权限"}}),a("el-table-column",{attrs:{prop:"createuid",label:"创建人"}}),a("el-table-column",{attrs:{prop:"createtime",label:"创建时间"}}),a("el-table-column",{attrs:{prop:"parentpath",label:"父路径"}})],1),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{visible:e.dialog.dialogVisible,title:e.dialog.dialogTitle,"append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"dialogVisible",t)}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.dialog.ruleFormLoading,expression:"dialog.ruleFormLoading"}],ref:"ruleForm",staticStyle:{"margin-right":"28px"},attrs:{size:"small",model:e.formcol,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.formcol.name,callback:function(t){e.$set(e.formcol,"name",t)},expression:"formcol.name"}})],1),a("el-form-item",{attrs:{label:"上级角色",prop:"parentpath"}},[a("el-cascader",{staticStyle:{width:"100%"},attrs:{clearable:"",options:e.TreeSelectList,props:{expandTrigger:"click",checkStrictly:!0}},model:{value:e.formcol.parentpath,callback:function(t){e.$set(e.formcol,"parentpath",t)},expression:"formcol.parentpath"}})],1),a("el-form-item",{attrs:{label:"显示顺序",prop:"seqno"}},[a("el-input-number",{attrs:{min:1,max:1e3,label:"顺序"},model:{value:e.formcol.seqno,callback:function(t){e.$set(e.formcol,"seqno",t)},expression:"formcol.seqno"}})],1),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-radio",{attrs:{label:1},model:{value:e.formcol.status,callback:function(t){e.$set(e.formcol,"status",t)},expression:"formcol.status"}},[e._v("启用")]),a("el-radio",{attrs:{label:0},model:{value:e.formcol.status,callback:function(t){e.$set(e.formcol,"status",t)},expression:"formcol.status"}},[e._v("停用")])],1),a("el-form-item",{attrs:{label:"说明",prop:"notes"}},[a("el-input",{attrs:{type:"textarea",rows:"4"},model:{value:e.formcol.notes,callback:function(t){e.$set(e.formcol,"notes",t)},expression:"formcol.notes"}})],1),a("el-form-item",{attrs:{label:"菜单权限",prop:"menus"}},[a("el-card",{attrs:{shadow:"never"}},[a("el-tree",{ref:"eltree",attrs:{data:e.MenuTree.data,"show-checkbox":"","node-key":"id",props:e.MenuTree.defaultProps}})],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.dialog.btnSavaLoading},on:{click:e.AddSubmit}},[e._v("保存")]),a("el-button",{on:{click:function(t){e.dialog.dialogVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},l=[],n=(a("4de4"),a("a15b"),a("d81d"),a("ac1f"),a("1276"),a("96cf"),a("1da1")),o=a("3e9f"),i=a("a118"),s={components:{},data:function(){return{defaultexpand:!1,isLineWarp:!1,radioId:0,orgTable:{data:[],defaultProps:{children:"children"},loading:!1},MenuTree:{data:[],defaultProps:{children:"children"},loading:!1},isAdd:!1,formcol:{id:0,name:"",seqno:0,status:1,notes:"",parentid:0,parentpath:"0"},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"blur"}]},dialog:{ruleFormLoading:!1,dialogVisible:!1,btnSavaLoading:!1,dialogTitle:"添加角色"},TreeSelectList:[]}},create:function(){},mounted:function(){this.fetchData()},methods:{getSelectMenuTree:function(){var e=this;i["a"].GetTreeSelect().then((function(t){e.MenuTree.data=t.data})).catch((function(t){e.$message.error("获取菜单树状结构失败"+t.msg)}))},getSelectTree:function(){var e=this;o["a"].GetTreeSelect().then((function(t){e.TreeSelectList=t.data})).catch((function(t){e.$message.error("获取树状结构失败"+t.msg)}))},AddSubmit:function(){var e=this,t=this;this.$refs.ruleForm.validate(function(){var a=Object(n["a"])(regeneratorRuntime.mark((function a(r){var l,n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!r){a.next=22;break}if(t.formcol.parentpath&&(t.formcol.parentpath=t.formcol.parentpath.join("-")),l=t.$refs.eltree.getCheckedKeys(),n=t.$refs.eltree.getHalfCheckedKeys(),l&&(t.formcol.menus=l.join("-")),l&&n&&(t.formcol.halfmenus=n.join("-")),t.dialog.btnSavaLoading=!0,!t.isAdd){a.next=13;break}return a.next=10,o["a"].Add(e.formcol);case 10:i=a.sent,a.next=16;break;case 13:return a.next=15,o["a"].Update(e.formcol);case 15:i=a.sent;case 16:e.$message.success(i.msg),e.fetchData(),e.dialog.btnSavaLoading=!1,e.dialog.dialogVisible=!1,a.next=23;break;case 22:return a.abrupt("return",!1);case 23:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())},editClick:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,r,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.multipleSelection,a&&0!=a.length){t.next=3;break}return t.abrupt("return",e.$message.info("请选择待操作记录"));case 3:return e.dialog.dialogVisible=!0,e.dialog.btnSavaLoading=!1,e.isAdd=!1,e.dialog.ruleFormLoading=!0,e.dialog.dialogTitle="修改角色数据",e.getSelectTree(),e.getSelectMenuTree(),t.next=12,o["a"].GetById(a[0].id);case 12:r=t.sent,e.formcol=r.data,e.formcol.menus&&(l=e.formcol.menus.split("-").map((function(e){return+e})),e.$refs.eltree.setCheckedKeys(l)),e.formcol.parentpath&&(e.formcol.parentpath=e.formcol.parentpath.split("-").map((function(e){return+e}))),e.dialog.ruleFormLoading=!1;case 17:case"end":return t.stop()}}),t)})))()},delClick:function(){var e=this,t=this.multipleSelection;if(!t||0==t.length)return this.$message.info("请选择待操作记录");var a=t[0].id;if(37==a)return this.$message.info("不能删除管理员组");this.$confirm("确定要删除此节点吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){o["a"].Del(t[0]).then((function(t){e.fetchData(),e.$message.success(t.msg)})).catch((function(t){e.$message.error("删除失败"+t.msg)}))}))},fetchData:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.orgTable.loading=!0,t.next=3,o["a"].GetTreeTable();case 3:a=t.sent,e.orgTable.data=a.data,e.orgTable.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},changeExpand:function(){this.defaultexpand?this.defaultexpand=!1:this.defaultexpand=!0},onSelectAll:function(){this.$refs.multipleTable.clearSelection()},selectItem:function(e){var t=this;if(e.length>1){var a=e.filter((function(a,r){return r==e.length-1?(t.$refs.multipleTable.toggleRowSelection(a,!0),!0):(t.$refs.multipleTable.toggleRowSelection(a,!1),!1)}));this.multipleSelection=a}else this.multipleSelection=e},onSelectOp:function(e){this.$refs.multipleTable.clearSelection(),this.$refs.multipleTable.toggleRowSelection(e,!0),this.multipleSelection=[],this.multipleSelection.push(e)},AddDialogOpen:function(){this.isAdd=!0,this.dialog.dialogTitle="添加新菜单",this.formcol={id:0,seqno:0,name:"",notes:"",status:1,parentid:0,parentpath:[]},this.dialog.dialogVisible=!0,this.getSelectTree(),this.getSelectMenuTree()}}},c=s,u=(a("be8a"),a("2877")),d=Object(u["a"])(c,r,l,!1,null,"0fbeaa5c",null);t["default"]=d.exports},be8a:function(e,t,a){"use strict";var r=a("361e"),l=a.n(r);l.a},d81d:function(e,t,a){"use strict";var r=a("23e7"),l=a("b727").map,n=a("1dde"),o=a("ae40"),i=n("map"),s=o("map");r({target:"Array",proto:!0,forced:!i||!s},{map:function(e){return l(this,e,arguments.length>1?arguments[1]:void 0)}})}}]);