(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65ecfb62"],{"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"25f0":function(e,t,a){"use strict";var i=a("6eeb"),n=a("825a"),r=a("d039"),l=a("ad6d"),o="toString",s=RegExp.prototype,c=s[o],u=r((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),d=c.name!=o;(u||d)&&i(RegExp.prototype,o,(function(){var e=n(this),t=String(e.source),a=e.flags,i=String(void 0===a&&e instanceof RegExp&&!("flags"in s)?l.call(e):a);return"/"+t+"/"+i}),{unsafe:!0})},3002:function(e,t,a){"use strict";var i=a("b775");t["a"]={getDataPage:function(e){return Object(i["a"])({url:"/object/ObjectDb/getDataPage",method:"post",data:e})},GetDatabaseList:function(){return Object(i["a"])({url:"/object/ObjectDb/GetDatabaseList",method:"get"})},GetDbAllTable:function(e){return Object(i["a"])({url:"/object/ObjectDb/GetDbAllTable",method:"get",params:{id:e}})},DataInsert:function(e){return Object(i["a"])({url:"/object/ObjectDb/insertData",method:"post",data:e})},DataUpdate:function(e){return Object(i["a"])({url:"/object/ObjectDb/updateData",method:"post",data:e})},DelDataByid:function(e,t){return Object(i["a"])({url:"/object/ObjectDb/DelDataByid",method:"get",params:{id:e,notes:t}})},getDataById:function(e){return Object(i["a"])({url:"/object/ObjectDb/getDataById",method:"get",params:{id:e}})},BackupDatabase:function(e){return Object(i["a"])({url:"/object/ObjectDb/BackupDatabase",method:"post",data:e})},GetAllBackupFileList:function(e){return Object(i["a"])({url:"/object/ObjectDb/GetAllBackupFileList",method:"get",params:{id:e}})}}},"4b6d":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticClass:"page-tools"},[a("el-col",{attrs:{span:19}},[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:e.addDialogOpen}},[e._v("添加记录")])],1),a("el-col",{attrs:{span:5}},[a("el-popover",{attrs:{width:"450",trigger:"click"}},[a("table",[a("tr",[a("td",[a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择列名"},model:{value:e.search.field,callback:function(t){e.$set(e.search,"field",t)},expression:"search.field"}},e._l(e.listQuery.ColumnHeader,(function(e){return a("el-option",{key:e.field,attrs:{label:e.title,value:e.field}})})),1)],1),a("td",[a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择条件"},model:{value:e.search.operator,callback:function(t){e.$set(e.search,"operator",t)},expression:"search.operator"}},e._l(e.search.QueryOperatorArr,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})})),1)],1),a("td",[a("el-input",{attrs:{placeholder:"请输入筛选内容"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchClick(t)}},model:{value:e.search.value,callback:function(t){e.$set(e.search,"value",t)},expression:"search.value"}})],1)]),a("tr",{staticStyle:{"text-align":"right"}},[a("td"),a("td"),a("td",[a("el-button",{attrs:{icon:"el-icon-search",type:"primary",size:"small"},on:{click:e.searchClick}},[e._v("确定")])],1)])]),a("el-button",{attrs:{slot:"reference",size:"mini",icon:"el-icon-search"},slot:"reference"})],1),a("el-button-group",[a("el-button",{attrs:{size:"mini"},on:{click:e.exportCsvEvent}},[e._v("Excel")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.fetchData}}),a("el-checkbox",{attrs:{label:"换行",size:"mini",border:""},model:{value:e.isLineWarp,callback:function(t){e.isLineWarp=t},expression:"isLineWarp"}})],1)],1)],1),a("elx-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"elxTable",staticStyle:{width:"100%"},attrs:{config:{render:"scroll"},data:e.tableData.data,height:e.tableHeight,"tooltip-effect":"dark",border:"","highlight-current-row":""}},[a("elx-table-column",{attrs:{type:"selection",width:"35"}}),a("elx-table-column",{attrs:{label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.editClick(t.row)}}},[a("i",{staticClass:"el-icon-edit"})]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.delClick(t.row,t.$index)}}},[a("i",{staticClass:"el-icon-delete"})])]}}])}),a("elx-table-column",{attrs:{label:"备份",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row["backuptime"]?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.backupDatabase(t.row)}}},[e._v(e._s(t.row["backuptime"]))]):a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.backupDatabase(t.row)}}},[e._v("未备份")])]}}])}),e._l(e.listQuery.ColumnHeader,(function(t){return a("elx-table-column",{key:t.field,attrs:{prop:t.field,"min-width":t.width,sortable:"","show-overflow-tooltip":!e.isLineWarp}},[a("template",{slot:"header"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"col.search"}],staticClass:"inputclass",attrs:{size:"mini",placeholder:t.title},domProps:{value:t.search},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.fetchData(t)},click:function(e){e.stopPropagation()},input:function(a){a.target.composing||e.$set(t,"search",a.target.value)}}}),a("i",{directives:[{name:"show",rawName:"v-show",value:t.search,expression:"col.search"}],staticClass:"el-icon-error closeicon",staticStyle:{"margin-left":"-16px"},on:{click:function(a){t.search="",e.fetchData(),a.stopPropagation()}}})])],2)}))],2),a("el-row",{staticClass:"table-footer"},[a("el-pagination",{attrs:{background:"","current-page":e.listQuery.currentPage,"page-size":e.listQuery.pageSize,"page-sizes":[100,200,500,1e3],layout:"sizes,prev, pager, next,total",total:e.tableData.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange,"update:currentPage":function(t){return e.$set(e.listQuery,"currentPage",t)},"update:current-page":function(t){return e.$set(e.listQuery,"currentPage",t)}}})],1),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{visible:e.backup.backupDialogVisible,title:e.backup.title,"append-to-body":"","close-on-click-modal":!0},on:{"update:visible":function(t){return e.$set(e.backup,"backupDialogVisible",t)}}},[a("el-table",{ref:"backupDatabase",staticStyle:{width:"100%"},attrs:{data:e.backup.backupFiles}},[a("el-table-column",{attrs:{prop:"fileName",label:"文件名",width:"300"}}),a("el-table-column",{attrs:{prop:"fileLength",label:"大小",width:"120"}}),a("el-table-column",{attrs:{prop:"fileWriteTime",label:"时间",width:"200"}})],1),a("el-button",{attrs:{type:"success",size:"mini",loading:e.backup.submitEventLoading},on:{click:e.backupSubmit}},[e._v("开始备份")])],1),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{visible:e.dialogVisible,title:e.dialogTitle,"append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.ruleFormLoading,expression:"ruleFormLoading"}],ref:"ruleForm",attrs:{size:"small",model:e.formcol,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:e.formcol.name,callback:function(t){e.$set(e.formcol,"name",t)},expression:"formcol.name"}})],1),a("el-form-item",{attrs:{label:"说明"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.formcol.notes,callback:function(t){e.$set(e.formcol,"notes",t)},expression:"formcol.notes"}})],1),a("el-form-item",{attrs:{label:"数据库类型"}},[a("el-select",{attrs:{placeholder:"请选择数据库"},on:{change:e.dbSelectChange},model:{value:e.formcol.dbtype,callback:function(t){e.$set(e.formcol,"dbtype",t)},expression:"formcol.dbtype"}},[a("el-option",{attrs:{label:"MySql",value:"MySql"}}),a("el-option",{attrs:{label:"SqlServer",value:"SqlServer"}}),a("el-option",{attrs:{label:"Oracle",value:"Oracle"}}),a("el-option",{attrs:{label:"PostgreSQL",value:"PostgreSQL"}})],1)],1),a("el-form-item",{attrs:{label:"数据库名"}},[a("el-input",{model:{value:e.formcol.dbname,callback:function(t){e.$set(e.formcol,"dbname",t)},expression:"formcol.dbname"}})],1),a("el-form-item",{attrs:{label:"只读"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.formcol.isreadonly,callback:function(t){e.$set(e.formcol,"isreadonly",t)},expression:"formcol.isreadonly"}})],1),a("el-form-item",{attrs:{label:"连接字符串"}},[a("el-input",{attrs:{type:"textarea",rows:"10"},model:{value:e.formcol.connstring,callback:function(t){e.$set(e.formcol,"connstring",t)},expression:"formcol.connstring"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.btnSavaLoading},on:{click:function(t){return e.AddSubmit("ruleForm")}}},[e._v("保存")]),a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")])],1)],1)],1)],1)},n=[],r=(a("99af"),a("c740"),a("4160"),a("c975"),a("baa5"),a("a434"),a("b0c0"),a("b64b"),a("d3b7"),a("ac1f"),a("25f0"),a("5319"),a("841c"),a("159b"),a("96cf"),a("1da1")),l=a("3002"),o={components:{},data:function(){return{tableHeight:window.innerHeight-150,mainSelection:[],tableData:{data:null,total:0},isLineWarp:!1,listLoading:!0,dialogLoading:!0,listQuery:{pageSize:100,currentPage:1,ColumnHeader:[]},dialogVisible:!1,btnSavaLoading:!1,dialogTitle:"添加数据",ruleFormLoading:!1,ruleForm:{},rules:{},isAdd:!1,formcol:{id:0,name:"",dbname:"",notes:"",createtime:"",createuid:"",updatetime:"",updateuid:"",connstring:"",dbtype:"",initkeytype:"",autoclose:1,isreadonly:0,backuptime:""},backup:{backupDialogVisible:!1,submitEventLoading:!1,title:"",backupRow:null,backupFiles:null},search:{dialogVisible:!1,operator:1,field:"",value:"",QueryOperatorArr:["等于","包含","大于","大于或等于","小于","小于或等于","在集合内","不在集合","左边匹配","右边匹配","不等于","为空","不为空","不匹配","时间段，用'|'隔开"]}}},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this;this.listLoading=!0,l["a"].getDataPage(this.listQuery).then((function(t){e.tableData.data=t.data,e.tableData.total=t.total,0==Object.keys(e.listQuery.ColumnHeader).length&&(e.listQuery.ColumnHeader=t.columns),e.listLoading=!1}))},searchClick:function(){var e=this,t=this.listQuery.ColumnHeader.findIndex((function(t){return t.field==e.search.field}));this.listQuery.ColumnHeader[t].search=this.search.value,this.listQuery.ColumnHeader[t].queryOperator=this.search.operator,this.fetchData()},handleSizeChange:function(e){this.listQuery.pageSize=e,this.fetchData()},handleCurrentChange:function(e){this.listQuery.currentPage=e,this.fetchData()},backupDatabase:function(e){var t=this;this.backup.backupDialogVisible=!0,this.backup.title=e.name+"备份记录",this.backup.backupRow=e,l["a"].GetAllBackupFileList(e.id).then((function(e){t.backup.backupFiles=e.data}))},backupSubmit:function(){var e=this;this.backup.submitEventLoading=!0,l["a"].BackupDatabase(this.backup.backupRow).then((function(t){e.$message.success(t.msg),e.backup.submitEventLoading=!1})),this.backup.submitEventLoading=!1},addDialogOpen:function(){this.isAdd=!0,this.dialogTitle="添加数据",this.formcol={id:0,name:"",title:"",notes:"",createtime:"",createuid:"",updatetime:"",updateuid:"",connstring:"",dbtype:"",initkeytype:"",autoclose:1,readonly:0,backuptime:""},this.dialogVisible=!0},AddSubmit:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.btnSavaLoading=!0,!e.isAdd){t.next=7;break}return t.next=4,l["a"].DataInsert(e.formcol);case 4:a=t.sent,t.next=10;break;case 7:return t.next=9,l["a"].DataUpdate(e.formcol);case 9:a=t.sent;case 10:e.$message.success(a.msg),e.fetchData(),e.btnSavaLoading=!1,e.dialogVisible=!1;case 14:case"end":return t.stop()}}),t)})))()},editClick:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.dialogVisible=!0,t.btnSavaLoading=!1,t.isAdd=!1,t.ruleFormLoading=!0,t.dialogTitle="修改数据",a.next=7,l["a"].getDataById(e.id);case 7:i=a.sent,t.formcol=i.data,t.ruleFormLoading=!1;case 10:case"end":return a.stop()}}),a)})))()},delClick:function(e,t){var a=this;this.tableData.istableedit?this.$prompt("请输入删除的原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"内容不能为空"}).then((function(e){var i=e.value;l["a"].DelDataByid(a.formcol.id,i).then((function(e){a.tableData.data.splice(t,1),a.$message.success(e.msg)})).catch((function(e){a.$message.error("删除失败"+e.msg)}))})):this.$message("您没有删除整行数据的权限。")},dbSelectChange:function(e){this.isAdd&&("MySql"==e&&(this.formcol.connstring="Data Source=数据库ip地址;User ID=sa;Password=数据库密码;Initial Catalog=数据库名;"),"SqlServer"==e&&(this.formcol.connstring="Data Source=数据库ip地址;User ID=sa;Password=数据库密码;Initial Catalog=数据库名;"),"Oracle"==e&&(this.formcol.connstring="Data Source=(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST = 数据库ip地址)(PORT = 1521))) (CONNECT_DATA = (SERVICE_NAME =orcl)));User Id=用户名;Password=数据库密码;"),"PostgreSQL"==e&&(this.formcol.connstring="PORT=5432;DATABASE=数据库名;HOST=数据库ip地址;PASSWORD=数据库密码;USER ID=postgres"))},exportCsvEvent:function(){var e="[{";this.listQuery.ColumnHeader.forEach((function(t){e+='"'+t.field+'":"'+t.title+'",'})),e=e.substring(0,e.lastIndexOf(",")),e+="}]";for(var t=JSON.parse(e),a=t.concat(this.tableData.data),i=0,n=a.length;i<n;i++)for(var r in a[i]){var l=a[i][r];null!=l&&-1!=l.toString().indexOf(",")&&(a[i][r]=a[i][r].replace(/,/g,"，")),null!=l&&-1!=l.toString().indexOf("\r\n")&&(a[i][r]=a[i][r].replace(/[\r\n]/g,""))}this.$refs.elxTable.exportCsv({filename:"Table",data:a,original:!0})}},mounted:function(){var e=this;window.onresize=function(){e.tableHeight=window.innerHeight-150}}},s=o,c=(a("59e8"),a("af6b"),a("2877")),u=Object(c["a"])(s,i,n,!1,null,"20901fc6",null);t["default"]=u.exports},"59e8":function(e,t,a){"use strict";var i=a("845c"),n=a.n(i);n.a},"841c":function(e,t,a){"use strict";var i=a("d784"),n=a("825a"),r=a("1d80"),l=a("129f"),o=a("14c3");i("search",1,(function(e,t,a){return[function(t){var a=r(this),i=void 0==t?void 0:t[e];return void 0!==i?i.call(t,a):new RegExp(t)[e](String(a))},function(e){var i=a(t,e,this);if(i.done)return i.value;var r=n(e),s=String(this),c=r.lastIndex;l(c,0)||(r.lastIndex=0);var u=o(r,s);return l(r.lastIndex,c)||(r.lastIndex=c),null===u?-1:u.index}]}))},"845c":function(e,t,a){},"88c5":function(e,t,a){},af6b:function(e,t,a){"use strict";var i=a("88c5"),n=a.n(i);n.a},b64b:function(e,t,a){var i=a("23e7"),n=a("7b0b"),r=a("df75"),l=a("d039"),o=l((function(){r(1)}));i({target:"Object",stat:!0,forced:o},{keys:function(e){return r(n(e))}})},baa5:function(e,t,a){var i=a("23e7"),n=a("e58c");i({target:"Array",proto:!0,forced:n!==[].lastIndexOf},{lastIndexOf:n})},c740:function(e,t,a){"use strict";var i=a("23e7"),n=a("b727").findIndex,r=a("44d2"),l=a("ae40"),o="findIndex",s=!0,c=l(o);o in[]&&Array(1)[o]((function(){s=!1})),i({target:"Array",proto:!0,forced:s||!c},{findIndex:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),r(o)},e58c:function(e,t,a){"use strict";var i=a("fc6a"),n=a("a691"),r=a("50c4"),l=a("a640"),o=a("ae40"),s=Math.min,c=[].lastIndexOf,u=!!c&&1/[1].lastIndexOf(1,-0)<0,d=l("lastIndexOf"),b=o("indexOf",{ACCESSORS:!0,1:0}),f=u||!d||!b;e.exports=f?function(e){if(u)return c.apply(this,arguments)||0;var t=i(this),a=r(t.length),l=a-1;for(arguments.length>1&&(l=s(l,n(arguments[1]))),l<0&&(l=a+l);l>=0;l--)if(l in t&&t[l]===e)return l||0;return-1}:c}}]);