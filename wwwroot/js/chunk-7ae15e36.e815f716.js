(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ae15e36"],{2405:function(e,t,r){"use strict";var n=r("b775");t["a"]={SysInstalled:function(){return Object(n["a"])({url:"/Install/SysInstalled",method:"get"})},FinishInstall:function(){return Object(n["a"])({url:"/Install/FinishInstall",method:"get"})},GetSysConfig:function(){return Object(n["a"])({url:"/Config/GetSysConfig",method:"get"})},SaveSysConfig:function(e){return Object(n["a"])({url:"/Config/SaveSysConfig",method:"post",data:e})},SaveUserConfig:function(e){return Object(n["a"])({url:"/Config/SaveUserConfig",method:"post",data:e})},InitSysData:function(){return Object(n["a"])({url:"/Install/InitSysData",method:"get"})}}},4354:function(e,t,r){},7181:function(e,t,r){"use strict";var n=r("4354"),a=r.n(n);a.a},ac93:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"gradient",attrs:{id:"box"}},[r("div",{staticClass:"con"},[r("span",{staticStyle:{"font-size":"40px"}},[e._v("系统安装设置")]),r("hr"),r("h4",[e._v("系统管理员：")]),r("el-form",{ref:"loginForm",staticClass:"ms-content",attrs:{model:e.loginForm,rules:e.rules,size:"small","label-width":"120px"}},[r("el-form-item",{attrs:{prop:"dbType",label:"数据库类型"}},[r("el-select",{attrs:{placeholder:"请选择数据库"},on:{change:e.dbSelectChange},model:{value:e.loginForm.dbType,callback:function(t){e.$set(e.loginForm,"dbType",t)},expression:"loginForm.dbType"}},[r("el-option",{attrs:{disabled:"",label:"MySql",value:"MySql"}}),r("el-option",{attrs:{disabled:"",label:"SqlServer",value:"SqlServer"}}),r("el-option",{attrs:{label:"Sqlite",value:"Sqlite"}}),r("el-option",{attrs:{disabled:"",label:"Oracle",value:"Oracle"}}),r("el-option",{attrs:{disabled:"",label:"PostgreSQL",value:"PostgreSQL"}})],1)],1),r("el-form-item",{attrs:{prop:"connStr",label:"连接字符串"}},[r("el-input",{attrs:{type:"textarea",rows:"10"},model:{value:e.loginForm.connStr,callback:function(t){e.$set(e.loginForm,"connStr",t)},expression:"loginForm.connStr"}})],1),r("el-form-item",{attrs:{label:"超级管理员",prop:"superUser"}},[r("el-input",{attrs:{disabled:"",clearable:"",placeholder:"superAdmin"},model:{value:e.loginForm.superUser,callback:function(t){e.$set(e.loginForm,"superUser",t)},expression:"loginForm.superUser"}})],1),r("el-form-item",{attrs:{label:"管理密码",prop:"superPass"}},[r("el-input",{attrs:{type:"password",placeholder:"password",clearable:"","show-password":""},model:{value:e.loginForm.superPass,callback:function(t){e.$set(e.loginForm,"superPass",t)},expression:"loginForm.superPass"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary",loading:e.btnSavaLoading},on:{click:e.SaveConfSubmit}},[e._v("1.保存配置")]),r("el-button",{attrs:{type:"warning",loading:e.btnInitDbLoading},on:{click:e.InitSysData}},[e._v("2.初始化基础表及数据")]),r("el-button",{attrs:{type:"success"},on:{click:e.logout}},[e._v("3.完成安装")])],1)],1)],1)])},a=[],s=(r("96cf"),r("1da1")),o=r("2405"),i={data:function(){return{ruleFormLoading:!1,isAdd:!0,btnSavaLoading:!1,loginForm:{connStr:"",dbType:"",superUser:"superAdmin",superPass:""},loading:!1,rules:{connStr:[{required:!0,message:"请输入数据库连接字符串",trigger:"blur"}],dbType:[{required:!0,message:"请选择数据库类型",trigger:"blur"}],superUser:[{required:!0,message:"请输入用户名",trigger:"blur"}],superPass:[{required:!0,message:"请输入密码",trigger:"blur"}]},btnInitDbLoading:!1}},mounted:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,n,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["a"].SysInstalled();case 2:return r=t.sent,n=r.ext,n&&(a=e.$store.getters.userinfo,a||e.$router.push("/"),"False"==a.isAdmin&&(e.$router.push("/"),e.$message.error("您没有管理此页面的权限。"))),t.next=7,o["a"].GetSysConfig();case 7:s=t.sent,e.loginForm=s.data;case 9:case"end":return t.stop()}}),t)})))()},methods:{dbSelectChange:function(e){this.isAdd&&("Sqlite"==e&&(this.loginForm.connStr="Sqlite数据库无须填写;"),"MySql"==e&&(this.loginForm.connStr="Data Source=数据库ip地址;User ID=sa;Password=数据库密码;Initial Catalog=数据库名;"),"SqlServer"==e&&(this.loginForm.connStr="Data Source=数据库ip地址;User ID=sa;Password=数据库密码;Initial Catalog=数据库名;"),"Oracle"==e&&(this.loginForm.connStr="Data Source=(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST = 数据库ip地址)(PORT = 1521))) (CONNECT_DATA = (SERVICE_NAME =orcl)));User Id=用户名;Password=数据库密码;"),"PostgreSQL"==e&&(this.loginForm.connStr="PORT=5432;DATABASE=数据库名;HOST=数据库ip地址;PASSWORD=数据库密码;USER ID=postgres"))},SaveConfSubmit:function(){var e=this;this.$refs.loginForm.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=9;break}return e.btnSavaLoading=!0,t.next=4,o["a"].SaveSysConfig(e.loginForm);case 4:n=t.sent,e.$message.success(n.msg),e.btnSavaLoading=!1,t.next=10;break;case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},InitSysData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.btnInitDbLoading=!0,t.prev=1,t.next=4,o["a"].InitSysData();case 4:r=t.sent,e.$message.success(r.msg),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),e.btnInitDbLoading=!1;case 11:e.btnInitDbLoading=!1;case 12:case"end":return t.stop()}}),t,null,[[1,8]])})))()},logout:function(){var e=this;o["a"].FinishInstall().then((function(t){e.$message.warn(t.msg)})),this.$store.dispatch("FedLogOut").then((function(){e.$router.push("/"),location.reload()}))}}},l=i,u=(r("7181"),r("2877")),c=Object(u["a"])(l,n,a,!1,null,"5034a06c",null);t["default"]=c.exports}}]);